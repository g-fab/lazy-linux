#!/bin/bash

# Message d'accueil ASCII (affichÃ© Ã  chaque connexion)
cat > /etc/profile.d/lazy-welcome.sh <<'EOF'
#!/bin/bash

# Afficher seulement dans les shells interactifs
if [[ $- == *i* ]]; then
    cat << 'WELCOME'

   _                    _     _                 
  | |    __ _ _____   _| |   (_)_ __  _   ___  __
  | |   / _` |_  / | | | |   | | '_ \| | | \ \/ /
  | |__| (_| |/ /| |_| | |___| | | | | |_| |>  < 
  |_____\__,_/___|\__, |_____|_|_| |_|\__,_/_/\_\
                  |___/                          

ðŸ“‹ Configuration post-installation recommandÃ©e:
   â€¢ Wireshark: sudo usermod -aG wireshark $USER && newgrp wireshark
   â€¢ Sensors:   sensors-setup (alias pour sensors-detect --auto)

ðŸ”§ Commandes utiles :
   â€¢ sudo lazy-setup  â†’ Configuration systÃ¨me (SSH, firewall)
   â€¢ update           â†’ Mise Ã  jour systÃ¨me
   â€¢ ll / lla         â†’ Listage dÃ©taillÃ©
   â€¢ ports            â†’ Voir les ports ouverts
   â€¢ snano            â†’ Nano en sudo
   â€¢ c                â†’ Clear Terminal
   â€¢ lazy-audit       â†’ Auditer la sÃ©curitÃ© du systÃ¨me avec Lynis

ðŸ› ï¸  Outils disponibles :
   Monitoring: htop, glances
   RÃ©seau: nmap, tcpdump, wireshark, iperf3, mtr
   SystÃ¨me: smartmontools, lm-sensors
   Backup: rsync, rclone
   SÃ©curitÃ©: ufw, fail2ban, apparmor, lynis

WELCOME

fi
EOF

chmod +x /etc/profile.d/lazy-welcome.sh

# Script lazy-setup
cat > /usr/local/bin/lazy-setup <<'EOF'
#!/bin/bash

if [ "$EUID" -ne 0 ]; then
    echo "Veuillez exÃ©cuter en tant que root (sudo)"
    exit 1
fi

echo "=== Configuration Lazy Linux ==="
echo ""

# Changer le port SSH
read -p "Nouveau port SSH (22 par dÃ©faut) : " SSH_PORT
SSH_PORT=${SSH_PORT:-22}

sed -i "s/^#\?Port .*/Port $SSH_PORT/" /etc/ssh/sshd_config
echo "âœ“ Port SSH configurÃ© : $SSH_PORT"

# Ajouter rÃ¨gle firewall
ufw allow $SSH_PORT/tcp
echo "âœ“ RÃ¨gle firewall ajoutÃ©e"

# RedÃ©marrer SSH
systemctl restart sshd
echo "âœ“ Service SSH redÃ©marrÃ©"

echo ""
echo "Configuration terminÃ©e !"
echo "N'oubliez pas d'activer ufw : sudo ufw enable"
EOF

chmod +x /usr/local/bin/lazy-setup
